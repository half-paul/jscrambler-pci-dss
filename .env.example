# ============================================================================
# Script Integrity Monitor - Environment Configuration
# ============================================================================
# Copy this file to .env and update with your actual values

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# Database type: 'sqlite' (development) or 'postgres' (production)
DB_TYPE=sqlite

# SQLite configuration (used when DB_TYPE=sqlite)
SQLITE_PATH=./data/integrity-monitor.db

# PostgreSQL configuration (used when DB_TYPE=postgres)
# Uncomment and configure for production
# PG_HOST=localhost
# PG_PORT=5432
# PG_DATABASE=script_integrity
# PG_USER=postgres
# PG_PASSWORD=your_secure_password_here
# PG_SSL=false

# Query logging (set to 'true' for debugging)
LOG_QUERIES=false

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================

# Server port
PORT=3000

# Node environment: 'development', 'staging', or 'production'
NODE_ENV=development

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================

# CORS allowed origins (comma-separated, or '*' for all)
# Production should specify exact origins
CORS_ORIGIN=*

# Salt for hashing IP addresses (change in production!)
IP_SALT=change-this-to-random-string-in-production

# Session secret (change in production!)
SESSION_SECRET=change-this-to-random-string-in-production

# JWT Configuration (for MFA authentication)
JWT_SECRET=change-this-to-random-jwt-secret-in-production
JWT_EXPIRES_IN=1h                # JWT token expiration
JWT_REFRESH_EXPIRES_IN=7d        # Refresh token expiration

# ============================================================================
# NOTIFICATION CONFIGURATION
# ============================================================================

# Email notifications (optional)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=your-email@example.com
# SMTP_PASSWORD=your-app-password
# SMTP_FROM=Script Monitor <noreply@your-domain.com>

# Slack notifications (optional)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Default notification recipients
# ALERT_EMAIL=security-team@your-domain.com
# ALERT_SLACK_CHANNEL=#security-alerts

# ============================================================================
# RATE LIMITING
# ============================================================================

# Rate limit windows (milliseconds)
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes

# Maximum requests per window
RATE_LIMIT_MAX_REQUESTS=100

# Registration limit per hour
REGISTRATION_LIMIT_PER_HOUR=200

# ============================================================================
# MONITORING & LOGGING
# ============================================================================

# Enable request logging
ENABLE_REQUEST_LOGGING=true

# Log level: 'error', 'warn', 'info', 'debug'
LOG_LEVEL=info

# ============================================================================
# ADMIN CONFIGURATION
# ============================================================================

# Default admin API token (CHANGE IN PRODUCTION!)
# This is created in the database during initialization
DEFAULT_ADMIN_TOKEN=demo-token-12345

# Session timeout (minutes)
ADMIN_SESSION_TIMEOUT=30

# Maximum failed login attempts before lockout
MAX_FAILED_LOGIN_ATTEMPTS=5

# Account lockout duration (minutes)
ACCOUNT_LOCKOUT_DURATION=30

# ============================================================================
# DATA RETENTION
# ============================================================================

# How long to keep resolved violations (days)
RETENTION_DAYS_VIOLATIONS=365

# How long to keep audit logs (days) - PCI DSS requires 7 years (2555 days)
RETENTION_DAYS_AUDIT=2555

# Auto-cleanup schedule (cron format: minute hour day month weekday)
# Default: Run daily at 2 AM
CLEANUP_SCHEDULE=0 2 * * *

# ============================================================================
# CLIENT CONFIGURATION
# ============================================================================

# These can be overridden per-environment in script-integrity-config.js

# Default poll interval for approval status (milliseconds)
DEFAULT_POLL_INTERVAL=30000

# Default poll timeout (milliseconds)
DEFAULT_POLL_TIMEOUT=300000

# Server request timeout (milliseconds)
SERVER_REQUEST_TIMEOUT=5000

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Database connection pool size (PostgreSQL only)
DB_POOL_MIN=2
DB_POOL_MAX=10

# Request body size limit
REQUEST_SIZE_LIMIT=10mb

# Enable compression
ENABLE_COMPRESSION=true

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable automatic approval for whitelisted domains
AUTO_APPROVAL_ENABLED=false

# Enable notification queue processing
ENABLE_NOTIFICATIONS=true

# Enable metrics collection
ENABLE_METRICS=false

# ============================================================================
# DEVELOPMENT / DEBUG
# ============================================================================

# Enable debug mode (verbose logging)
DEBUG=false

# Enable SQL query debugging
DEBUG_SQL=false

# Disable authentication (DEVELOPMENT ONLY - NEVER IN PRODUCTION!)
DISABLE_AUTH=false

# ============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ============================================================================
# Before deploying to production, ensure you:
# [ ] Changed all default passwords and tokens
# [ ] Updated CORS_ORIGIN to specific domains
# [ ] Set NODE_ENV=production
# [ ] Configured PostgreSQL database
# [ ] Set up email/Slack notifications
# [ ] Configured proper IP_SALT and SESSION_SECRET
# [ ] Reviewed and adjusted rate limits
# [ ] Set up SSL/TLS certificates
# [ ] Configured firewall rules
# [ ] Set up backup strategy for database
# [ ] Reviewed security headers in helmet configuration
# [ ] Tested disaster recovery procedures
# ============================================================================
